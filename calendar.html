<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kalender</title>
<style>
body { font-family: Arial; margin:0; background:#f4f6f8; }
header { background:#0f5f57; color:white; padding:15px; display:flex; justify-content:space-between; align-items:center; }
header button { background:#ffffff33; border:none; padding:8px 14px; color:white; border-radius:6px; cursor:pointer; }
.container { max-width:700px; margin:auto; padding:20px; }
.calendar { display:grid; grid-template-columns:repeat(7,1fr); gap:5px; }
.day { background:white; border-radius:6px; min-height:80px; padding:5px; position:relative; text-align:center; }
.dot { width:8px; height:8px; background:red; border-radius:50%; display:inline-block; margin-top:5px; }
</style>
</head>
<body>
<header>
    <h2>Kalender</h2>
    <button onclick="window.location.href='index.html'">Zur Ãœbersicht</button>
</header>
<div class="container">
    <div id="calendar" class="calendar"></div>
</div>

<script type="module">
import { db } from "./firebase-config.js";
import { ref, get } from "https://www.gstatic.com/firebasejs/9.8.3/firebase-database.js";

const calendarEl = document.getElementById("calendar");
let currentDate = new Date();

async function loadEvents(){
    const snapshot = await get(ref(db,"events"));
    return snapshot.exists() ? snapshot.val() : {};
}

async function drawCalendar(){
    calendarEl.innerHTML="";
    const year = currentDate.getFullYear();
    const month = currentDate.getMonth();
    const firstDay = new Date(year, month, 1).getDay();
    const lastDate = new Date(year, month+1, 0).getDate();
    const events = await loadEvents();
    const eventDays = Object.values(events).map(e=>new Date(e.date).getDate());

    for(let i=0;i<firstDay;i++){ calendarEl.appendChild(document.createElement("div")); }

    for(let d=1; d<=lastDate; d++){
        const dayEl = document.createElement("div");
        dayEl.className="day";
        dayEl.textContent=d;
        if(eventDays.includes(d)) { 
            const dot = document.createElement("div"); 
            dot.className="dot"; 
            dayEl.appendChild(dot);
        }
        calendarEl.appendChild(dayEl);
    }
}

drawCalendar();
</script>
</body>
</html>
