<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Event Planer</title>
<style>
body { margin:0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:#eaeaea; }
header { background:#1b2a49; color:white; padding:15px 30px; display:flex; justify-content:space-between; align-items:center; }
header h2 { margin:0; font-weight:400; font-size:1.5rem; }
header button { background:#f39c12; border:none; padding:10px 16px; color:white; font-weight:bold; border-radius:8px; cursor:pointer; transition:0.3s; }
header button:hover { background:#e67e22; }

.container { max-width:1100px; margin:auto; padding:20px; }
.event-list { display:grid; grid-template-columns:repeat(auto-fill,minmax(300px,1fr)); gap:20px; margin-top:20px; }
.card { background:white; padding:18px; border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,0.1); transition:0.3s; }
.card:hover { box-shadow:0 10px 25px rgba(0,0,0,0.15); }
.card h3 { margin:0 0 10px 0; color:#1b2a49; font-weight:600; }
.card p { margin:4px 0; font-size:0.9rem; }
.card button { margin-top:8px; padding:6px 10px; border:none; border-radius:6px; cursor:pointer; transition:0.2s; }
.card button:hover { opacity:0.85; }

#addEventForm { display:none; background:white; padding:25px; border-radius:12px; box-shadow:0 6px 25px rgba(0,0,0,0.15); margin-top:20px; }
label { display:block; margin-top:10px; font-weight:500; color:#333; }
input, select, textarea { width:100%; padding:8px; border-radius:8px; border:1px solid #ccc; margin-top:5px; font-size:0.95rem; }
textarea { resize:none; }

button.saveBtn { background:#1b2a49; color:white; width:100%; padding:12px; font-weight:bold; margin-top:15px; border-radius:8px; cursor:pointer; transition:0.3s; }
button.saveBtn:hover { background:#34495e; }

#toast { position:fixed; top:20px; left:50%; transform:translateX(-50%); background:#1b2a49; padding:12px 20px; color:white; border-radius:10px; display:none; font-weight:500; text-align:center; }

/* Login */
#loginContainer { display:flex; height:100vh; justify-content:center; align-items:center; background:#1b2a49; }
#loginBox { background:white; padding:40px; border-radius:16px; width:320px; box-shadow:0 10px 30px rgba(0,0,0,0.2); }
#loginBox h2 { text-align:center; margin-bottom:30px; color:#1b2a49; font-weight:600; }
#loginBox select, #loginBox input { margin-top:10px; padding:10px; border-radius:8px; border:1px solid #ccc; width:100%; }
#loginBox button { background:#1b2a49; color:white; width:100%; padding:12px; margin-top:20px; font-weight:bold; border-radius:8px; cursor:pointer; transition:0.3s; }
#loginBox button:hover { background:#34495e; }
</style>
</head>
<body>

<!-- Login -->
<div id="loginContainer">
    <div id="loginBox">
        <h2>Login</h2>
        <label>Benutzer</label>
        <select id="userSelect">
            <option value="admin">Admin</option>
            <option value="teacher">Lehrer*innen</option>
        </select>
        <label>Passwort</label>
        <input type="password" id="password">
        <button id="loginBtn">Login</button>
    </div>
</div>

<!-- Hauptseite -->
<div id="mainContainer" style="display:none;">
<header>
    <h2>Event Übersicht</h2>
    <button id="addEventBtn">Event hinzufügen</button>
</header>

<div class="container">
    <div id="toast"></div>

    <div id="addEventForm">
        <h3>Neues Event</h3>
        <label>Name</label>
        <input id="name" type="text">
        <label>Leiter</label>
        <input id="leader" type="text">
        <label>Typ</label>
        <select id="type">
            <option>Probe</option>
            <option>Konzert</option>
            <option>Theater</option>
            <option>Konferenz</option>
            <option>Präsentation</option>
            <option>Rede</option>
            <option>Andere</option>
        </select>
        <label>Ort</label>
        <select id="location">
            <option>Atrium</option>
            <option>Forum</option>
        </select>
        <label>Mikros</label>
        <select id="mic">
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
            <option>mehr</option>
        </select>
        <label>Gesangsmikros</label>
        <select id="vocals">
            <option>0</option>
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
            <option>mehr</option>
        </select>
        <label>Rednerpult</label>
        <select id="podium">
            <option>Ja</option>
            <option>Nein</option>
        </select>
        <label>Beamer</label>
        <select id="beamer">
            <option>Ja Bühne</option>
            <option>Ja Wand</option>
            <option>Ja beide</option>
            <option>Nein</option>
        </select>
        <label>Keyboards</label>
        <select id="keyboard">
            <option>0</option>
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
        </select>
        <label>Gitarren</label>
        <select id="guitar">
            <option>0</option>
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
        </select>
        <label>Kommentar (optional)</label>
        <textarea id="comments"></textarea>
        <label>Datum & Uhrzeit</label>
        <input type="datetime-local" id="eventDate">

        <button class="saveBtn" id="saveEvent">Speichern</button>
    </div>

    <div class="event-list" id="eventsContainer"></div>
</div>
</div>

<script type="module">
// Firebase import
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getDatabase, ref, set, push, onValue, remove } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyCXX4CwnX_eRiKBURJeORfGoYI0k0hdHkA",
  authDomain: "event-plan-c4b36.firebaseapp.com",
  databaseURL: "https://event-plan-c4b36-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "event-plan-c4b36",
  storageBucket: "event-plan-c4b36.appspot.com",
  messagingSenderId: "489710650124",
  appId: "1:489710650124:web:6a515ffd6ec3d9983aff29"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// Login
const loginBtn = document.getElementById('loginBtn');
const loginContainer = document.getElementById('loginContainer');
const mainContainer = document.getElementById('mainContainer');

loginBtn.addEventListener('click', () => {
    const user = document.getElementById('userSelect').value;
    const password = document.getElementById('password').value;
    if((user==='admin' && password==='2309')||(user==='teacher' && password==='event')){
        loginContainer.style.display = 'none';
        mainContainer.style.display = 'block';
        loadEvents();
    } else {
        alert('Falsches Passwort');
    }
});

// Event hinzufügen toggle
const addEventBtn = document.getElementById('addEventBtn');
const addEventForm = document.getElementById('addEventForm');
addEventBtn.addEventListener('click', () => {
    addEventForm.style.display = addEventForm.style.display==='none'?'block':'none';
});

// Toast Funktion
function showToast(msg){
    const toast = document.getElementById('toast');
    toast.innerText = msg;
    toast.style.display='block';
    setTimeout(()=>{toast.style.display='none';},3000);
}

// Events laden
const eventsContainer = document.getElementById('eventsContainer');
function loadEvents(){
    eventsContainer.innerHTML='';
    const eventsRef = ref(db, 'events');
    onValue(eventsRef, (snapshot)=>{
        eventsContainer.innerHTML='';
        snapshot.forEach((childSnap)=>{
            const data = childSnap.val();
            const id = childSnap.key;
            const card = document.createElement('div');
            card.className='card';
            card.innerHTML = `<h3>${data.name}</h3>
                <p><strong>Leiter:</strong> ${data.leader}</p>
                <p><strong>Typ:</strong> ${data.type}</p>
                <p><strong>Ort:</strong> ${data.location}</p>
                <p><strong>Mikros:</strong> ${data.mic}</p>
                <p><strong>Gesangsmikros:</strong> ${data.vocals}</p>
                <p><strong>Rednerpult:</strong> ${data.podium}</p>
                <p><strong>Beamer:</strong> ${data.beamer}</p>
                <p><strong>Keyboards:</strong> ${data.keyboard}</p>
                <p><strong>Gitarren:</strong> ${data.guitar}</p>
                <p><strong>Kommentar:</strong> ${data.comments}</p>
                <p><strong>Datum:</strong> ${data.date}</p>
                <button onclick="editEvent('${id}')">Bearbeiten</button>
                <button onclick="deleteEvent('${id}')">Löschen</button>`;
            eventsContainer.appendChild(card);
        });
    });
}

// Event löschen
window.deleteEvent = function(id){
    if(confirm('Event wirklich löschen?')){
        remove(ref(db, 'events/'+id));
    }
}

// Event bearbeiten
window.editEvent = function(id){
    const eventsRef = ref(db,'events/'+id);
    onValue(eventsRef, (snapshot)=>{
        const data = snapshot.val();
        addEventForm.style.display='block';
        document.getElementById('name').value=data.name;
        document.getElementById('leader').value=data.leader;
        document.getElementById('type').value=data.type;
        document.getElementById('location').value=data.location;
        document.getElementById('mic').value=data.mic;
        document.getElementById('vocals').value=data.vocals;
        document.getElementById('podium').value=data.podium;
        document.getElementById('beamer').value=data.beamer;
        document.getElementById('keyboard').value=data.keyboard;
        document.getElementById('guitar').value=data.guitar;
        document.getElementById('comments').value=data.comments;
        document.getElementById('eventDate').value=data.date;

        saveEventBtn.onclick = ()=>{
            set(eventsRef,{
                name: document.getElementById('name').value,
                leader: document.getElementById('leader').value,
                type: document.getElementById('type').value,
                location: document.getElementById('location').value,
                mic: document.getElementById('mic').value,
                vocals: document.getElementById('vocals').value,
                podium: document.getElementById('podium').value,
                beamer: document.getElementById('beamer').value,
                keyboard: document.getElementById('keyboard').value,
                guitar: document.getElementById('guitar').value,
                comments: document.getElementById('comments').value,
                date: document.getElementById('eventDate').value
            });
            addEventForm.reset();
            addEventForm.style.display='none';
            showToast('Event aktualisiert!');
            saveEventBtn.onclick = saveNewEvent;
        };
    });
}

// Neues Event speichern (nur einmal)
function saveNewEvent(){
    const eventData = {
        name: document.getElementById('name').value,
        leader: document.getElementById('leader').value,
        type: document.getElementById('type').value,
        location: document.getElementById('location').value,
        mic: document.getElementById('mic').value,
        vocals: document.getElementById('vocals').value,
        podium: document.getElementById('podium').value,
        beamer: document.getElementById('beamer').value,
        keyboard: document.getElementById('keyboard').value,
        guitar: document.getElementById('guitar').value,
        comments: document.getElementById('comments').value,
        date: document.getElementById('eventDate').value
    };
    const eventsRef = ref(db, 'events');
    push(eventsRef, eventData);
    addEventForm.reset();
    addEventForm.style.display='none';
    showToast('Event gespeichert!');
    loadEvents(); // zurück zur Übersicht
}

const saveEventBtn = document.getElementById('saveEvent');
saveEventBtn.onclick = saveNewEvent;

</script>
</body>
</html>
